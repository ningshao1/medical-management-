(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-40e0096e"],{"386d":function(e,t,a){"use strict";var n=a("cb7c"),r=a("83a1"),s=a("5f1b");a("214f")("search",1,function(e,t,a,i){return[function(a){var n=e(this),r=void 0==a?void 0:a[t];return void 0!==r?r.call(a,n):new RegExp(a)[t](String(n))},function(e){var t=i(a,e,this);if(t.done)return t.value;var c=n(e),l=String(this),o=c.lastIndex;r(o,0)||(c.lastIndex=0);var u=s(c,l);return r(c.lastIndex,o)||(c.lastIndex=o),null===u?-1:u.index}]})},"83a1":function(e,t){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e===1/t:e!=e&&t!=t}},"9cef":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-card",e._b({staticClass:"kld-card-wrap",attrs:{shadow:e.shadow}},"el-card",e.$attrs,!1),[e.noheader?e._e():a("div",{staticClass:"kld-card__header",class:e.headerClassName,style:e._headerStyle,attrs:{slot:"header"},slot:"header"},[e._t("header",[a("div",{staticClass:"kld-card-head",attrs:{slot:"header"},slot:"header"},[a("div",{staticClass:"head-title-wrap"},[e._t("head-title",[e._t("title-prefix-icon",[e.namePrefix?a("div",{staticClass:"head-title-prefix"}):e._e()]),e._t("title-text",[a("div",{staticClass:"head-title-content"},[e._v("\n                                "+e._s(e.title)+"\n                            ")])])])],2),a("div",{staticClass:"head-icon-wrap"},[e._t("head-icon",[e.noHeadIcon?e._e():["link"===e.mode?[a("router-link",{staticClass:"head-icon-link",attrs:{to:e.to,tag:"span"}},[e._v("\n                                    查看更多\n                                    "),a("i",{staticClass:"el-icon-arrow-right head-icon-icon"})])]:"switch"===e.mode?[a("el-switch",e._g(e._b({model:{value:e.switchValue,callback:function(t){e.switchValue=t},expression:"switchValue"}},"el-switch",e.$attrs,!1),e.$listeners))]:e._e()]])],2)])])],2),a("div",{staticClass:"kld-card__body",class:e.bodyClassName,style:e._bodyStyle},[e._t("default")],2)])},r=[],s=a("cebc"),i={name:"kld-card",props:{value:{default:!1},namePrefix:{default:!0},noheader:{type:Boolean,default:!1},noHeadIcon:{type:Boolean,default:!1},mode:{default:"link"},title:{default:"卡片名称"},to:{default:function(){return{}}},shadow:{default:"never"},headerStyle:{default:function(){return{}}},bodyStyle:{default:function(){return{}}},bodyClassName:{},headerClassName:{}},data:function(){return{baseStyle:{header:{padding:"0 20px",height:"52px"},body:{padding:"0 20px 18px"}}}},computed:{switchValue:{get:function(){return this.value},set:function(e){this.$emit("input",e)}},noheaderStyle:function(){return{header:Object(s["a"])({},this.baseStyle.header,{}),body:Object(s["a"])({},this.baseStyle.body,{padding:"18px 20px"})}},_headerStyle:function(){return Object(s["a"])({},this.noheader?this.noheaderStyle.header:this.baseStyle.header,this.headerStyle)},_bodyStyle:function(){return Object(s["a"])({},this.noheader?this.noheaderStyle.body:this.baseStyle.body,this.bodyStyle)}},created:function(){},methods:{}},c=i,l=a("2877"),o=Object(l["a"])(c,n,r,!1,null,"0f7810c1",null);t["a"]=o.exports},c680:function(e,t,a){"use strict";var n=a("5176"),r=a.n(n),s=(a("96cf"),a("3b8d")),i=(a("386d"),a("cebc"));t["a"]={data:function(){return{search:{},searchAdvanced:{},searchInEffect:{},data:[],loading:!1,page:{total:0,current:1,size:10}}},watch:{search:{deep:!0,handler:function(e){this.mergeSearch(e)}}},created:function(){var e=this;this.searchInEffect=Object(i["a"])({},this.search,this.searchAdvanced),this.$watch("searchInEffect",function(){e.page.current=1,e.getList()},{deep:!0})},methods:{getList:function(){var e=Object(s["a"])(regeneratorRuntime.mark(function e(){var t,a,n,r,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,e.prev=1,t=this.page,e.next=5,this.$axios.post(this.url,{offset:t.size*(t.current-1),limit:t.size,params:this.searchInEffect});case 5:a=e.sent,n=a.data,r=n.data,s=n.recordsTotal,this.data=r,this.page.total=s;case 11:return e.prev=11,this.loading=!1,e.finish(11);case 14:case"end":return e.stop()}},e,this,[[1,,11,14]])}));function t(){return e.apply(this,arguments)}return t}(),mergeSearch:function(e){r()(this.searchInEffect,e)}}}},dbe2:function(e,t,a){"use strict";a.r(t);var n,r,s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("kld-card",{attrs:{noheader:""}},[a("div",{staticClass:"relevance"},[a("div",{staticClass:"tree"},[a("el-input",{staticClass:"exist-input",attrs:{placeholder:"请输入科室名"},model:{value:e.osNameKey,callback:function(t){e.osNameKey=t},expression:"osNameKey"}}),a("kld-tree",{ref:"relevance-tree",attrs:{data:e.departmentTree,"first-expand":"",props:{label:"osName"}},model:{value:e.search.osid,callback:function(t){e.$set(e.search,"osid",t)},expression:"search.osid"}})],1),a("div",{staticClass:"content"},[a("div",{staticClass:"table"},[a("el-table",{attrs:{data:e.data}},[a("el-table-column",{attrs:{prop:"ar_time",label:"申请时间"}}),a("el-table-column",{attrs:{prop:"ar_type",label:"采购类型"},scopedSlots:e._u([{key:"default",fn:function(t){var a=t.row;return[e._v("\n                            "+e._s(e._f("typeName")(a.ar_type))+"\n                        ")]}}])}),a("el-table-column",{attrs:{prop:"uName",label:"申请人"}}),a("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.row;return[a("a",{attrs:{href:"javascript:;"},on:{click:function(t){e.chooseHandler(n)}}},[e._v(e._s(n.id===e.currentId?"已关联":"选择关联"))])]}}])})],1)],1),a("el-pagination",{staticStyle:{"text-align":"center"},attrs:{"current-page":e.page.current,total:e.page.total,"page-size":e.page.size,layout:"prev, pager, next"},on:{"update:currentPage":function(t){e.$set(e.page,"current",t)},"current-change":e.getList}})],1)]),a("choose-relevance",{attrs:{visible:e.visible,currentId:e.clickCurrentId,apId:e.apId},on:{"update:visible":function(t){e.visible=t},ok:e.ok}})],1)},i=[],c=a("cebc"),l=(a("a481"),a("96cf"),a("3b8d")),o=a("bd86"),u=(a("7f7f"),a("dd55")),d=a("9cef"),p=a("c680"),h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",e._g(e._b({attrs:{title:"采购计划",visible:e.dialogShow,"custom-class":"relevance-dialog"},on:{"update:visible":function(t){e.dialogShow=t}}},"el-dialog",e.$attrs,!1),e.$listeners),[a("div",{staticClass:"relevance-body"},[a("kld-card",{staticClass:"bb-1",attrs:{title:"采购类型",noHeadIcon:""}},[e._v("\n            "+e._s(e.typeName)+"\n        ")]),a("kld-card",{staticClass:"bb-1",attrs:{title:"基础信息",noHeadIcon:""}},[a("el-form",{staticClass:"relevance-form",attrs:{"label-width":"100px",inline:!0}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"申请科室："}},[a("div",{staticClass:"baisc-info"},[e._v(e._s(e.osName))])])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"申请时间："}},[a("div",{staticClass:"baisc-info"},[e._v(" "+e._s(e.time))])])],1),a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{label:"科室电话："}},[a("div",{staticClass:"baisc-info"},[e._v(" "+e._s(e.osPhone))])])],1)],1)],1)],1),a("kld-card",{staticClass:"bb-1",attrs:{title:"设备采购信息",noHeadIcon:""}},[a("el-radio-group",{staticClass:"relcvance-radio-group",model:{value:e.relevanceId,callback:function(t){e.relevanceId=t},expression:"relevanceId"}},[a("el-table",{attrs:{data:e.annualplanPurchases,"row-style":{cursor:"pointer"}},on:{"row-click":e.rowClick}},[a("el-table-column",{attrs:{label:"序号"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.$index,r=t.row,s=r.id,i=r.type,c=r.relevanceNumber,l=r.openNumber;return[a("el-radio",{attrs:{label:s,disabled:2!=i||c>=l},nativeOn:{click:function(t){t.preventDefault(),t.stopPropagation(),e.rowClick({id:s,type:i,relevanceNumber:c,openNumber:l})}}},[e._v("\n                                "+e._s((e.page.current-1)*e.page.size+n+1)+"\n\n                            ")])]}}])}),a("el-table-column",{attrs:{prop:"ap_name",label:"设备名称"}}),a("el-table-column",{attrs:{prop:"ap_number",label:"数量",width:"80"}}),a("el-table-column",{attrs:{prop:"ap_money",label:"预算单价"}}),a("el-table-column",{attrs:{prop:"ap_brand",label:"意向品牌（多选）"}}),a("el-table-column",{attrs:{prop:"ap_note",label:"备注"}})],1)],1),a("el-pagination",{staticStyle:{"text-align":"center"},attrs:{"current-page":e.page.current,total:e.page.total,"page-size":e.page.size,layout:"prev, pager, next"},on:{"update:currentPage":function(t){e.$set(e.page,"current",t)},"current-change":e.getList}})],1)],1),e._t("footer",[a("div",[a("el-button",{attrs:{type:"default"},on:{click:function(t){e.dialogShow=!1}}},[e._v("\n                取消\n            ")]),a("el-button",{on:{click:e.confirm}},[e._v("确定")])],1)],{slot:"footer"})],2)},f=[],b=a("cee7"),m={0:"10万元以下",1:"10~50万元",2:"50万元以上"},v={name:"chooseRelevance",mixins:[p["a"]],props:{currentId:{type:String},visible:{type:Boolean,default:!1},apId:{type:String}},data:function(){return{page:{current:1,total:3,size:3},typeName:"",time:"",osName:"",osPhone:"",annualplanPurchases:[],relevanceId:""}},components:(n={},Object(o["a"])(n,b["a"].name,b["a"]),Object(o["a"])(n,d["a"].name,d["a"]),n),computed:{url:function(){return"/annualplan/getAnnualplan/".concat(this.currentId)},dialogShow:{get:function(){return this.visible},set:function(e){this.$emit("update:visible",e)}}},watch:{currentId:function(){this.page.current=1,this.getList()},visible:function(){this.relevanceId=this.apId}},created:function(){},methods:{getList:function(){var e=this,t=this.page;this.$axios.post(this.url,{offset:t.size*(t.current-1),limit:t.size,params:{}}).then(function(t){var a=t.data,n=a.ar_type,r=a.osName,s=a.ar_time,i=a.osPhone,c=a.annualplanPurchases,l=a.count;e.typeName=m[String(n)],e.time=s,e.osName=r,e.osPhone=i,e.annualplanPurchases=c,e.page.total=l})},rowClick:function(e){var t=e.id,a=e.type,n=e.relevanceNumber,r=e.openNumber;2==a?n>=r?this.$message.warning("该年度计划关联资产数已达上限，无法选择关联！"):this.relevanceId===t?this.relevanceId="":this.relevanceId=t:this.$message.warning("该采购条例没有被同意,无法关联！")},confirm:function(){this.dialogShow=!1,this.$emit("ok",this.relevanceId,this.currentId)}}},g=v,y=a("2877"),_=Object(y["a"])(g,h,f,!1,null,"60b1ff8c",null),w=_.exports,x=a("3f06"),k={0:"10万元以下",1:"10~50万元",2:"50万元以上"},I={mixins:[p["a"]],data:function(){return{departmentTree:[],osNameKey:null,search:{plan:2,osid:""},clickCurrentId:null,visible:!1,apId:"",currentId:""}},components:(r={},Object(o["a"])(r,u["a"].name,u["a"]),Object(o["a"])(r,d["a"].name,d["a"]),Object(o["a"])(r,w.name,w),r),computed:{url:function(){return"/annualplan/annualplanList"}},watch:{osNameKey:function(e){this.$refs["relevance-tree"].filter(e)}},created:function(){this.loadDepartmentTree(),this.getList()},filters:{typeName:function(e){return k[String(e)]}},methods:{loadDepartmentTree:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("loadDepartmentTree");case 2:t=e.sent,this.departmentTree=[t];case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),chooseHandler:function(e){var t=e.id;this.clickCurrentId=t,this.visible=!0},ok:function(e,t){this.apId=e,this.currentId=e?t:""},jumpOver:function(){var e=this;Object(x["b"])({title:"提示",content:"确认跳过？",okText:"确定",cancelText:"取消",ok:function(){e.$axios.post("/assetacceptance/skip/".concat(e.$route.query.id)).then(function(t){e.$message.success("已跳过采购计划关联！"),e.$router.go(-1)})}})},next:function(e){var t=this;this.apId?Object(x["b"])({title:"提示",content:"确认保存采购计划关联",okText:"确定",cancelText:"取消",ok:function(){t.$axios.post("/assetacceptance/saveAnnualPlan",{assetId:t.$route.query.id,apId:t.apId}).then(function(a){t.$message.success("采购计划关联成功！"),e&&e(),t.$router.replace({name:t.$route.name,query:Object(c["a"])({},t.$route.query,{step:3})})})}}):this.$message.warning("您没有关联采购计划，如需跳过请点击跳过按钮！")}}},C=I,S=Object(y["a"])(C,s,i,!1,null,"758c1bce",null),$=S.exports;a.d(t,"default",function(){return $})}}]);
//# sourceMappingURL=chunk-40e0096e.0509bb61.js.map