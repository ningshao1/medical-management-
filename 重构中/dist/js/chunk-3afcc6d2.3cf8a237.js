(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3afcc6d2"],{"0390":function(e,t,s){"use strict";var a=s("02f4")(!0);e.exports=function(e,t,s){return t+(s?a(e,t).length:1)}},"0bfb":function(e,t,s){"use strict";var a=s("cb7c");e.exports=function(){var e=a(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},"18f4":function(e,t,s){"use strict";s.r(t);var a,r=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"asset-add-modify-wrap"},[s("el-form",{ref:"form",staticClass:"asset-add-modify-form",attrs:{model:e.assetItems,rules:e.ruleValidate}},[s("div",{staticClass:"asset-add-modify-container"},[s("div",{staticClass:"main-info-grid"},[s("el-row",[s("el-col",[s("base-info",{attrs:{"asset-items":e.assetItems,"origin-asset-items":e.originAssetItems},on:{"update:assetItems":function(t){e.assetItems=t}}})],1),s("el-col",[s("asset-bind-contract",{attrs:{"asset-items":e.assetItems,"origin-asset-items":e.originAssetItems},on:{"update:assetItems":function(t){e.assetItems=t}}})],1),s("el-col",[s("depreciation-info",{attrs:{"asset-items":e.assetItems,"origin-asset-items":e.originAssetItems},on:{"update:assetItems":function(t){e.assetItems=t}}})],1),e.isMeasure?s("el-col",[s("measurement-info",{attrs:{"asset-items":e.assetItems,"origin-asset-items":e.originAssetItems},on:{"update:assetItems":function(t){e.assetItems=t}}})],1):e._e()],1)],1),s("div",{staticClass:"additional-info-grid"},[s("additional-info",{attrs:{"asset-items":e.assetItems,"origin-asset-items":e.originAssetItems},on:{"update:assetItems":function(t){e.assetItems=t}}})],1)])]),s("Portal",{staticClass:"footer-button",attrs:{to:"breadcrumb"}},[e.isAdd?[s("el-button",{attrs:{type:"default"}},[e._v("返回")]),s("el-button",{attrs:{loading:e.submiting},on:{click:e.checkAdd}},[e._v("确定")])]:[s("el-button",{attrs:{type:"default"}},[e._v("返回")]),s("el-button",{attrs:{loading:e.submiting,disabled:!e.originAssetItemsLoaded},on:{click:e.checkModify}},[e._v("确定")])]],2)],1)},n=[],i=s("f499"),o=s.n(i),l=s("cebc"),c=(s("96cf"),s("3b8d")),u=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"base-info-wrap"},[s("kld-card",{attrs:{title:"基本信息","no-head-icon":""}},[s("div",{staticClass:"full-width"},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:12,lg:6}},[s("el-form-item",{attrs:{label:"设备名称",prop:"assetName"}},[s("float-table",{attrs:{placeholder:"请输入设备名称",columns:e.assetName.columns,"remote-method":e.assetNameAutocomplete,"value-key":e.assetName.valueKey},on:{select:e.getPreInfo},model:{value:e.cardItems.assetName,callback:function(t){e.$set(e.cardItems,"assetName",t)},expression:"cardItems.assetName"}})],1)],1),s("el-col",{attrs:{span:12,lg:6}},[s("el-form-item",{attrs:{label:"型号",prop:"assetClass"}},[s("float-table",{attrs:{placeholder:"请填写设备型号",columns:e.assetClass.columns,"remote-method":e.assetClassAutocomplete,"value-key":e.assetClass.valueKey},on:{select:e.getPreInfo},model:{value:e.cardItems.assetClass,callback:function(t){e.$set(e.cardItems,"assetClass",t)},expression:"cardItems.assetClass"}})],1)],1),s("el-col",{attrs:{span:12,lg:6}},[s("el-form-item",{attrs:{label:"序列号",prop:"assetSN"}},[s("asset-sn",{attrs:{placeholder:"请填写设备序列号"},model:{value:e.cardItems.assetSN,callback:function(t){e.$set(e.cardItems,"assetSN",t)},expression:"cardItems.assetSN"}})],1)],1),s("el-col",{attrs:{span:12,lg:6}},[s("el-form-item",{attrs:{label:"设备注册证号",prop:"registration"}},[s("el-input",{attrs:{placeholder:"请填写设备型号"},model:{value:e.cardItems.registration,callback:function(t){e.$set(e.cardItems,"registration",t)},expression:"cardItems.registration"}})],1)],1),s("el-col",{attrs:{span:24}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:e.viewBreatheType?12:24}},[s("el-form-item",{attrs:{label:"设备分类",prop:"assertTypeId"}},[s("tree-select",{attrs:{data:e.country.list,"leaf-only":"","code-prefix":"",placeholder:"请选择设备分类"},on:{"current-change":e.assertTypeChange},model:{value:e.cardItems.assertTypeId,callback:function(t){e.$set(e.cardItems,"assertTypeId",t)},expression:"cardItems.assertTypeId"}})],1)],1),e.viewBreatheType?s("el-col",{attrs:{span:12}},[s("el-form-item",{attrs:{label:"呼吸机分类",prop:"breatheType"}},[s("el-radio-group",{staticClass:"full-width inline-block",model:{value:e.cardItems.breatheType,callback:function(t){e.$set(e.cardItems,"breatheType",t)},expression:"cardItems.breatheType"}},[s("el-radio",{attrs:{label:2}},[e._v("无创")]),s("el-radio",{attrs:{label:3}},[e._v("有创")]),s("el-radio",{attrs:{label:4}},[e._v("混合型")])],1)],1)],1):e._e()],1)],1),s("el-col",{attrs:{span:12,lg:6}},[s("el-form-item",{attrs:{label:"品牌",prop:"assetBrandId"}},[s("float-table",{ref:"asset-brand",attrs:{"selected-item":e.selectedItem,placeholder:"请选择品牌","remote-no-keyword":"",columns:e.assetBrand.columns,"remote-method":e.brandNameAutocomplete,"value-key":e.assetBrand.valueKey,"node-key":e.assetBrand.nodeKey},on:{"update:selectedItem":function(t){e.selectedItem=t}},model:{value:e.assetBrand.brandName,callback:function(t){e.$set(e.assetBrand,"brandName",t)},expression:"assetBrand.brandName"}})],1)],1),s("el-col",{attrs:{span:12,lg:6}},[s("el-form-item",{attrs:{label:"领用时间",prop:"collarTime"}},[s("el-date-picker",{attrs:{editable:!1,clearable:"",disabled:e.collarTimeDisabled,"value-format":"yyyy-MM-dd",placeholder:"请选择领用时间"},on:{change:e.collarTimeChange},model:{value:e.cardItems.collarTime,callback:function(t){e.$set(e.cardItems,"collarTime",t)},expression:"cardItems.collarTime"}})],1)],1),s("el-col",{attrs:{span:12,lg:6}},[s("el-form-item",{attrs:{label:"现有编码",prop:"oldAssetCode"}},[s("el-input",{attrs:{placeholder:"请填写设备现有编码"},model:{value:e.cardItems.oldAssetCode,callback:function(t){e.$set(e.cardItems,"oldAssetCode",t)},expression:"cardItems.oldAssetCode"}})],1)],1),s("el-col",{attrs:{span:12,lg:6}},[s("el-form-item",{attrs:{label:"资产标签",prop:"assetLabelType"}},[s("el-select",{attrs:{placeholder:"请选择资产标签"},model:{value:e.cardItems.assetLabelType,callback:function(t){e.$set(e.cardItems,"assetLabelType",t)},expression:"cardItems.assetLabelType"}},[s("el-option",{attrs:{value:1,label:"已贴"}}),s("el-option",{attrs:{value:2,label:"未贴"}})],1)],1)],1),s("el-col",{attrs:{span:12,lg:6}},[s("el-form-item",{attrs:{label:"所属科室",prop:"departmentId"}},[s("tree-select",{attrs:{data:e.departmentTree,placeholder:"请选择所属科室",props:{label:"osName"},"first-expand":"","ban-select":[e.osId]},on:{"current-change":e.departmentChange},model:{value:e.cardItems.departmentId,callback:function(t){e.$set(e.cardItems,"departmentId",t)},expression:"cardItems.departmentId"}})],1)],1),s("el-col",{attrs:{span:12,lg:6}},[s("el-form-item",{attrs:{label:"安装地点",prop:"installSection"}},[s("tree-select",{attrs:{data:e.departmentTree,placeholder:"请选择安装地点",props:{label:"osName"},"first-expand":"","ban-select":[e.osId]},model:{value:e.cardItems.installSection,callback:function(t){e.$set(e.cardItems,"installSection",t)},expression:"cardItems.installSection"}})],1)],1),s("el-col",{attrs:{span:12,lg:6}},[s("el-form-item",{attrs:{label:"管理人",prop:"userId"}},[s("el-input",{attrs:{disabled:!0,placeholder:"选择所属科室自动填充"},model:{value:e.cardItems.userName,callback:function(t){e.$set(e.cardItems,"userName",t)},expression:"cardItems.userName"}})],1)],1),s("el-col",{attrs:{span:12,lg:6}},[s("el-form-item",{attrs:{label:"责任人",prop:"responsibleId"}},[s("el-input",{attrs:{disabled:!0,placeholder:"选择所属科室自动填充"},model:{value:e.cardItems.responsibleName,callback:function(t){e.$set(e.cardItems,"responsibleName",t)},expression:"cardItems.responsibleName"}})],1)],1)],1)],1)])],1)},d=[],m=(s("c5f6"),s("bd86")),p=s("e1db"),h=s("e341"),f=s("4660"),b=s("3e18"),g={name:"base-info",mixins:[p["b"]],components:{TreeSelect:h["a"],FloatTable:f["a"],AssetSn:b["a"]},props:{},data:function(){return{assetName:{columns:[{key:"assetName",title:"名称"},{key:"assetClass",title:"型号"},{key:"brandName",title:"品牌"}],valueKey:"assetName"},assetClass:{columns:[{key:"assetName",title:"名称"},{key:"assetClass",title:"型号"},{key:"brandName",title:"品牌"}],valueKey:"assetClass"},assetBrand:{brandName:"",columns:[{key:"brandName",title:"名称"},{key:"manufactor",title:"厂商"},{key:"modeCountry",title:"国别"}],valueKey:"brandName",nodeKey:"brandId"},country:{list:[]},departmentTree:[]}},computed:{viewBreatheType:function(){return 1!==this.cardItems.breatheType&&0!==this.cardItems.breatheType},collarTimeDisabled:function(){return!this.isAdd&&!(!this.originAssetItems.collarTime||"0"==this.originAssetItems.purchaseMount)},selectedItem:{get:function(){var e,t=this.assetBrand,s=t.valueKey,a=t.nodeKey;return e={},Object(m["a"])(e,s,this.cardItems.brandName),Object(m["a"])(e,a,this.cardItems.assetBrandId),e},set:function(e){var t=this.assetBrand,s=t.valueKey,a=t.nodeKey,r=e[s],n=e[a];this.cardItems.assetBrandId=n,this.cardItems.brandName=r}}},created:function(){this.loadCountryType(),this.loadDepartmentTree()},methods:{loadCountryType:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("loadCountryType",!0);case 2:this.country.list=e.sent;case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),loadDepartmentTree:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$store.dispatch("loadDepartmentTree");case 2:t=e.sent,this.departmentTree=[t];case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),assetNameAutocomplete:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,s,a){var r,n,i,o,l,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=s.pageSize,n=s.currentPage,s.total,i={limit:r,offset:(n-1)*r,params:{name:t}},o=null,e.prev=3,e.next=6,this.$axios.post("assets/getOtherByAssetName",i);case 6:l=e.sent,c=l.data,o=c;case 9:return e.prev=9,a(o),e.finish(9);case 12:case"end":return e.stop()}},e,this,[[3,,9,12]])}));function t(t,s,a){return e.apply(this,arguments)}return t}(),getPreInfo:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var s,a,r,n,i,o,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return s=t.assetName,a=t.assetClass,r=t.assetId,n=t.id,i=r||n,this.cardItems.assetName=s,this.cardItems.assetClass=a,e.next=6,this.$axios.post("/assets/getOtherByAssetId?id=".concat(i));case 6:o=e.sent,l=o.data,this.preInfoFormat(l);case 9:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),preInfoFormat:function(e){var t=this;e=e||{};var s=e,a=s.brandName,r=s.assetBrandId,n=s.depreciationAgeLimit,i=s.registration,o=s.assertTypeId,l=(s.hosId,s.breathe_type);if(a&&r){var c,u=this.assetBrand,d=u.valueKey,p=u.nodeKey;this.selectedItem=(c={},Object(m["a"])(c,d,a),Object(m["a"])(c,p,r),c)}n&&(this.cardItems.depreciationAgeLimit=n),i&&(this.cardItems.registration=i),o&&(this.cardItems.assertTypeId=o),l&&this.$nextTick(function(){t.cardItems.assertTypeId&&(t.cardItems.breatheType=l)}),this.osId},assetClassAutocomplete:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,s,a){var r,n,i,o,l,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=s.pageSize,n=s.currentPage,s.total,i={limit:r,offset:(n-1)*r,params:{assetClass:t}},o=null,e.prev=3,e.next=6,this.$axios.post("assets/getAssetClass",i);case 6:l=e.sent,c=l.data,o=c;case 9:return e.prev=9,a(o),e.finish(9);case 12:case"end":return e.stop()}},e,this,[[3,,9,12]])}));function t(t,s,a){return e.apply(this,arguments)}return t}(),brandNameAutocomplete:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,s,a){var r,n,i,o,l,c;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=s.pageSize,n=s.currentPage,s.total,i={limit:r,offset:(n-1)*r,params:{keyword:t}},o=null,e.prev=3,e.next=6,this.$axios.post("assertBrandcopys/".concat(this.osId,"/list"),i);case 6:l=e.sent,c=l.data,o=c;case 9:return e.prev=9,a(o),e.finish(9);case 12:case"end":return e.stop()}},e,this,[[3,,9,12]])}));function t(t,s,a){return e.apply(this,arguments)}return t}(),assertTypeChange:function(e,t){var s=this;if(t){var a=Number(3===e.state||2===e.state||1===e.state);this.cardItems.lifeType!==a&&(this.cardItems.used=1),this.cardItems.lifeType=a,this.cardItems.assertTypeId=t.key,this.cardItems.assertTypeName=e.typeName;var r=this.cardItems.breatheType;this.cardItems.breatheType=2===e.state?r>=2?r:2:1,this.$nextTick(function(){s.cardItems.mtType=e.type})}},collarTimeChange:function(e){e&&(this.cardItems.assetWarrntyDate=this.dayjs(e).add(1,"year").format("YYYY-MM-DD"))},departmentChange:function(e,t){t=t||{};var s=t,a=s.key,r=s.label;this.cardItems.osName=r,this.cardItems.installSection=a,this.getOrgstructResponsible(a)},getOrgstructResponsible:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t){var s,a,r,n,i,o,l;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=6;break}return e.next=3,this.$axios.get("orgstruct/".concat(t,"/getOrgstructResponsible"));case 3:e.t0=e.sent,e.next=7;break;case 6:e.t0={};case 7:s=e.t0,a=s.data,r=a||{},n=r.responsible,i=r.responsibleName,o=r.user,l=r.userName,this.cardItems.userId=o,this.cardItems.userName=l,this.cardItems.responsibleId=n,this.cardItems.responsibleName=i;case 15:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()}},v=g,y=s("2877"),I=Object(y["a"])(v,u,d,!1,null,"6c6bb55e",null),T=I.exports,x=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"additional-info-wrap"},[s("kld-card",{attrs:{noheader:""}},[s("el-row",[s("el-col",[s("el-form-item",{attrs:{prop:"used",label:"设备状态"}},[s("el-radio-group",{model:{value:e.cardItems.used,callback:function(t){e.$set(e.cardItems,"used",t)},expression:"cardItems.used"}},e._l(e.usedTypes,function(t){var a=t.label,r=t.text;return s("el-radio",{key:a,attrs:{label:a}},[e._v(e._s(r))])}),1)],1)],1),s("el-col",[s("el-form-item",{attrs:{prop:"labelIds",label:"设备标签"}},[s("el-select",{attrs:{multiple:"","multiple-limit":5},model:{value:e.cardItems.labelIds,callback:function(t){e.$set(e.cardItems,"labelIds",t)},expression:"cardItems.labelIds"}},[e._l(e.labels,function(e,t){return[s("el-option",{key:t,attrs:{label:e.labelName,value:e.id}})]})],2)],1)],1),s("el-col",[s("el-form-item",{attrs:{label:"设备图片",prop:"photos"}},[s("div",{staticClass:"full-width inline-block"},[s("kld-upload",{model:{value:e.cardItems.photos,callback:function(t){e.$set(e.cardItems,"photos",t)},expression:"cardItems.photos"}})],1)])],1),s("el-col")],1)],1)],1)},w=[],k=s("b9ce"),$=(a={name:"additional-info",mixins:[p["b"]],components:{KldUpload:k["a"]},props:{},data:function(){return{used:{types:[{label:1,text:"在用",type:"noraml"},{label:3,text:"备用",type:"noraml"},{label:0,text:"闲置",type:"unlive"},{label:4,text:"待用",type:"live"}]},labels:[]}},created:{},computed:{usedTypes:function(){var e=this;return this.used.types.filter(function(t){var s=t.type;return e.cardItems.lifeType?"unlive"!==s:"live"!==s})},labelIds:{get:function(){return this.cardItems.labelIds||[]},set:function(e){this.cardItems.labelIds=e||[]}}}},Object(m["a"])(a,"created",function(){this.getLabels()}),Object(m["a"])(a,"methods",{getLabels:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.post("/labels/list/1");case 2:t=e.sent,s=t.data,this.labels=s;case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}),a),N=$,A=Object(y["a"])(N,x,w,!1,null,"36dc74bd",null),C=A.exports,O=s("a1fd"),S=s("8e65"),j=s("bee8"),R=s("7f7d"),M=s("ed08"),D={name:"asset-add-modify",components:{BaseInfo:T,AdditionalInfo:C,assetBindContract:O["a"],depreciationInfo:S["a"],measurementInfo:j["a"],Portal:R["a"]},mixins:[p["a"]],props:{},data:function(){var e=this,t="该项为必填项！",s=new Error(t),a=function(){var t=Object(c["a"])(regeneratorRuntime.mark(function t(s,a,r){var n,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(a!==e.originAssetItems.assetSN){t.next=2;break}return t.abrupt("return",r());case 2:return t.next=4,e.$axios.get("/assets/checkSn?snCode=".concat(a));case 4:if(n=t.sent,i=n.data,0!==i){t.next=8;break}return t.abrupt("return",r());case 8:return t.abrupt("return",r("该序列号已存在，请更换新的序列号！"));case 9:case"end":return t.stop()}},t,this)}));return function(e,s,a){return t.apply(this,arguments)}}(),r=function(t,a,r){!e.isAdd&&e.originAssetItems.collarTime&&!a||e.isAdd&&!a?r(s):e.assetItems.collarTime&&e.assetItems.assetWarrntyDate&&new Date(e.assetItems.collarTime)>new Date(e.assetItems.assetWarrntyDate)?r(new Error("领用时间应早于过保时间！")):r()},n=function(t,a,r){a?e.assetItems.collarTime&&e.assetItems.assetWarrntyDate&&new Date(e.assetItems.collarTime)>new Date(e.assetItems.assetWarrntyDate)?r(new Error("领用时间应早于过保时间！")):r():r(s)},i=function(t,a,r){if(null===a||""===a){if(0===e.assetItems.mtType)return r(s);if(e.assetItems.lastTime||e.assetItems.cycle)return r(s);if(!e.isAdd&&(e.originAssetItems.lastTime||e.originAssetItems.cycle))return r(s)}r()},o=function(e,t,a){return t?a():a(s)};return{originAssetItems:{},originAssetItemsLoaded:!1,assetItems:{assetName:"",assetBrandId:"",brandName:"",assertTypeId:null,assertTypeName:void 0,breatheType:1,collarTime:null,departmentId:null,osName:"",installSection:null,userId:"",userName:"",responsibleId:"",responsibleName:"",assetSN:"",oldAssetCode:"",assetClass:"",used:1,registration:"",contractId:"",contractName:"",purchaseMount:"0",assetWarrntyDate:"",depreciationType:0,depreciationAgeLimit:5,speedDepreciationRate:"",lastTime:null,cycle:null,mtType:null,labelIds:[],assetLabelType:2,lifeType:0,photos:[]},ignoreItems:{add:{assertTypeName:void 0,brandName:void 0,contractName:void 0,osName:void 0},modify:{contractName:void 0}},submiting:!1,ruleValidate:{assetName:[{required:!0,message:t},{pattern:/^[\u4e00-\u9fa5\w()-]*$/,message:"设备名称仅支持中英文、数字、下划线、英文括号和短横线!",trigger:"blur"},{max:100,message:"最多100个字符！"}],assetBrandId:{required:!0,message:t,trigger:"change"},assertTypeId:{required:!0,validator:o,trigger:"change"},assetSN:[{required:!0,message:t,trigger:"change"},{validator:a,trigger:"change"}],collarTime:{required:!0,validator:r,trigger:"change"},departmentId:{required:!0,validator:o,trigger:"change"},userId:{required:!0,message:"此科室暂未设置管理人，请联系管理员添加！"},responsibleId:{required:!0,message:"此科室暂未设置负责人，请联系管理员添加！"},purchaseMount:{required:!0,message:t},assetWarrntyDate:{required:!0,validator:n,trigger:"change"},depreciationType:{required:!0,message:t},depreciationAgeLimit:{required:!0,message:t},lastTime:{validator:i,trigger:"change"},cycle:{validator:i,trigger:"change"},mtType:{validator:i,trigger:"change"},used:{required:!0,message:t}}}},computed:{isMeasure:function(){return null!==this.assetItems.mtType},checkMTLimit:function(){return this.isAdd?this.checkLimit("ass:measurement:add"):this.checkLimit("ass:measurement:edit")}},watch:{isMeasure:{handler:function(e){e||(this.assetItems.lastTime="",this.assetItems.cycle=null)},immediate:!0}},created:function(){},mounted:function(){this.isAdd||this.remoteAssetDetails()},methods:{checkModify:function(){this.formValidate(this.modify)},modify:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t,s,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.submiting=!0,e.prev=1,e.next=4,Object(M["d"])(this.assetItems.photos,7);case 4:return t=e.sent,s="/assets/".concat(this.osId),a=Object(l["a"])({},this.assetItems,{id:this.assetId,photos:t,purchaseMountFlag:+this.assetItems.purchaseMount!==+this.originAssetItems.purchaseMount?"true":"false",collarTimeFlag:(this.assetItems.collarTime!==this.originAssetItems.collarTime)+"",cycle:this.checkMTLimit?+this.assetItems.cycle||null:void 0,lastTime:this.checkMTLimit?this.assetItems.lastTime||null:void 0,mtType:this.checkMTLimit?this.assetItems.mtType:void 0},this.ignoreItems.modify),e.next=9,this.$axios.put(s,a);case 9:this.$message.success("编辑资产成功！"),this.submiting=!1,this.$router.go(-1);case 12:return e.prev=12,this.submiting=!1,e.finish(12);case 15:case"end":return e.stop()}},e,this,[[1,,12,15]])}));function t(){return e.apply(this,arguments)}return t}(),checkAdd:function(){this.formValidate(this.add)},remoteAssetDetails:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t,s;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.get("/assets/".concat(this.osId,"/").concat(this.assetId));case 2:return t=e.sent,s=t.data,this.originAssetItems=JSON.parse(o()(s)),this.originAssetItemsLoaded=!0,e.next=8,this.assetDetailsFormat(s,this.assetItems);case 8:this.assetItems=e.sent;case 9:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),assetDetailsFormat:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(t,s){var a,r,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:for(n in a=JSON.parse(o()(t)),r={},s)r[n]=a[n];return r.labelIds=(a.labels||[]).map(function(e){var t=e.labelId;return t}),r.photos=[],Object(c["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Object(M["e"])((a.photos||[]).map(function(e){var t=e.photoUrl;return t}));case 3:r.photos=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e["catch"](0),console.error(e.t0);case 9:case"end":return e.stop()}},e,this,[[0,6]])}))(),e.abrupt("return",r);case 6:case"end":return e.stop()}},e,this)}));function t(t,s){return e.apply(this,arguments)}return t}(),add:function(){var e=Object(c["a"])(regeneratorRuntime.mark(function e(){var t,s,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.submiting=!0,e.prev=1,e.next=4,Object(M["d"])(this.assetItems.photos,7);case 4:return t=e.sent,s="/assets/".concat(this.osId),a=Object(l["a"])({id:this.assetIdBySN||void 0,hosId:this.userInfo.osId},this.assetItems,{photos:t,speedDepreciationRate:this.assetItems.speedDepreciationRate||"0",cycle:this.checkMTLimit?+this.assetItems.cycle||null:void 0,lastTime:this.checkMTLimit?this.assetItems.lastTime||null:void 0,mtType:this.checkMTLimit?this.assetItems.mtType:void 0},this.ignoreItems.add),e.next=9,this.$axios.post(s,a);case 9:this.$message.success("新增资产成功！"),this.submiting=!1,this.$router.go(-1);case 12:return e.prev=12,this.submiting=!1,e.finish(12);case 15:case"end":return e.stop()}},e,this,[[1,,12,15]])}));function t(){return e.apply(this,arguments)}return t}(),formValidate:function(e,t){var s=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"form";t=t||function(){s.$message.error("请修改错误内容后提交！")},this.$refs[a].validate(function(s){s?e():t()})},propValidate:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"form";this.$refs[t].validateField(e)},resetForm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"form";this.$refs[e].resetFields()}}},L=D,B=Object(y["a"])(L,r,n,!1,null,"a94b0208",null),_=B.exports;s.d(t,"default",function(){return _})},"214f":function(e,t,s){"use strict";s("b0c5");var a=s("2aba"),r=s("32e9"),n=s("79e5"),i=s("be13"),o=s("2b4c"),l=s("520a"),c=o("species"),u=!n(function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")}),d=function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var s="ab".split(e);return 2===s.length&&"a"===s[0]&&"b"===s[1]}();e.exports=function(e,t,s){var m=o(e),p=!n(function(){var t={};return t[m]=function(){return 7},7!=""[e](t)}),h=p?!n(function(){var t=!1,s=/a/;return s.exec=function(){return t=!0,null},"split"===e&&(s.constructor={},s.constructor[c]=function(){return s}),s[m](""),!t}):void 0;if(!p||!h||"replace"===e&&!u||"split"===e&&!d){var f=/./[m],b=s(i,m,""[e],function(e,t,s,a,r){return t.exec===l?p&&!r?{done:!0,value:f.call(t,s,a)}:{done:!0,value:e.call(s,t,a)}:{done:!1}}),g=b[0],v=b[1];a(String.prototype,e,g),r(RegExp.prototype,m,2==t?function(e,t){return v.call(e,this,t)}:function(e){return v.call(e,this)})}}},"454f":function(e,t,s){s("46a7");var a=s("584a").Object;e.exports=function(e,t,s){return a.defineProperty(e,t,s)}},"46a7":function(e,t,s){var a=s("63b6");a(a.S+a.F*!s("8e60"),"Object",{defineProperty:s("d9f6").f})},"520a":function(e,t,s){"use strict";var a=s("0bfb"),r=RegExp.prototype.exec,n=String.prototype.replace,i=r,o="lastIndex",l=function(){var e=/a/,t=/b*/g;return r.call(e,"a"),r.call(t,"a"),0!==e[o]||0!==t[o]}(),c=void 0!==/()??/.exec("")[1],u=l||c;u&&(i=function(e){var t,s,i,u,d=this;return c&&(s=new RegExp("^"+d.source+"$(?!\\s)",a.call(d))),l&&(t=d[o]),i=r.call(d,e),l&&i&&(d[o]=d.global?i.index+i[0].length:t),c&&i&&i.length>1&&n.call(i[0],s,function(){for(u=1;u<arguments.length-2;u++)void 0===arguments[u]&&(i[u]=void 0)}),i}),e.exports=i},"5cd9":function(e,t,s){(function(t,a){e.exports=a(s("2b0e"))})(0,function(e){"use strict";e=e&&e.hasOwnProperty("default")?e["default"]:e;var t="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},a=function(e){if(Array.isArray(e)){for(var t=0,s=Array(e.length);t<e.length;t++)s[t]=e[t];return s}return Array.from(e)};function r(e){for(var t=e.hasAttributes()?e.attributes:[],s={},a=0;a<t.length;a++){var r=t[a];r.value&&(s[r.name]=""===r.value||r.value)}var n=void 0,i=void 0;s.class&&(n=s.class,delete s.class),s.style&&(i=s.style,delete s.style);var o={attrs:s,class:n,style:i};return o}function n(e){return Array.isArray(e)||"object"===("undefined"===typeof e?"undefined":t(e))?Object.freeze(e):e}function i(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e.reduce(function(e,s){var a=s.passengers[0];return a="function"===typeof a?a(t):s.passengers,e.concat(a)},[])}function o(e,t){return e.map(function(e,t){return[t,e]}).sort(function(e,t){return this(e[1],t[1])||e[0]-t[0]}.bind(t)).map(function(e){return e[1]})}var l={},c=e.extend({data:function(){return{transports:l}},methods:{open:function(t){var s=t.to,a=t.from,r=t.passengers;if(s&&a&&r){t.passengers=n(r);var i=Object.keys(this.transports);-1===i.indexOf(s)&&e.set(this.transports,s,[]);var l=this.getTransportIndex(t),c=this.transports[s].slice(0);-1===l?c.push(t):c[l]=t,this.transports[s]=o(c,function(e,t){return e.order-t.order})}},close:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=e.to,a=e.from;if(s&&a&&this.transports[s])if(t)this.transports[s]=[];else{var r=this.getTransportIndex(e);if(r>=0){var n=this.transports[s].slice(0);n.splice(r,1),this.transports[s]=n}}},hasTarget:function(e){return this.transports.hasOwnProperty(e)},hasContentFor:function(e){return!!this.transports[e]&&this.getContentFor(e).length>0},getSourceFor:function(e){return this.transports[e]&&this.transports[e][0].from},getContentFor:function(e){var t=this.transports[e];if(t)return i(t)},getTransportIndex:function(e){var t=e.to,s=e.from;for(var a in this.transports[t])if(this.transports[t][a].from===s)return a;return-1}}}),u=new c(l),d=/^(attrs|props|on|nativeOn|class|style|hook)$/,m=function(e){return e.reduce(function(e,t){var s,a,r,n,i;for(r in t)if(s=e[r],a=t[r],s&&d.test(r))if("class"===r&&("string"===typeof s&&(i=s,e[r]=s={},s[i]=!0),"string"===typeof a&&(i=a,t[r]=a={},a[i]=!0)),"on"===r||"nativeOn"===r||"hook"===r)for(n in a)s[n]=p(s[n],a[n]);else if(Array.isArray(s))e[r]=s.concat(a);else if(Array.isArray(a))e[r]=[s].concat(a);else for(n in a)s[n]=a[n];else e[r]=t[r];return e},{})};function p(e,t){return function(){e&&e.apply(this,arguments),t&&t.apply(this,arguments)}}var h={abstract:!1,name:"portalTarget",props:{attributes:{type:Object,default:function(){return{}}},multiple:{type:Boolean,default:!1},name:{type:String,required:!0},slim:{type:Boolean,default:!1},slotProps:{type:Object,default:function(){return{}}},tag:{type:String,default:"div"},transition:{type:[Boolean,String,Object],default:!1},transitionEvents:{type:Object,default:function(){return{}}}},data:function(){return{transports:u.transports,firstRender:!0}},created:function(){this.transports[this.name]||this.$set(this.transports,this.name,[])},mounted:function(){var e=this;this.unwatch=this.$watch("ownTransports",this.emitChange),this.$nextTick(function(){e.transition&&(e.firstRender=!1)}),this.$options.abstract&&(this.$options.abstract=!1)},updated:function(){this.$options.abstract&&(this.$options.abstract=!1)},beforeDestroy:function(){this.unwatch()},computed:{ownTransports:function(){var e=this.transports[this.name]||[];return this.multiple?e:0===e.length?[]:[e[e.length-1]]},passengers:function(){return i(this.ownTransports,this.slotProps)},hasAttributes:function(){return Object.keys(this.attributes).length>0},withTransition:function(){return!!this.transition},transitionData:function(){var e=this.transition,s={};return this.firstRender&&"object"===t(this.transition)&&!this.transition.appear?(s.props={name:"__notranstition__portal-vue__"},s):("string"===typeof e?s.props={name:e}:"object"===("undefined"===typeof e?"undefined":t(e))&&(s.props=e),this.renderSlim&&(s.props.tag=this.tag),s.on=this.transitionEvents,s)},transportedClasses:function(){return this.ownTransports.map(function(e){return e.class}).reduce(function(e,t){return e.concat(t)},[])}},methods:{emitChange:function(e,t){if(this.multiple)this.$emit("change",[].concat(a(e)),[].concat(a(t)));else{var r=0===e.length?void 0:e[0],n=0===t.length?void 0:t[0];this.$emit("change",s({},r),s({},n))}},children:function(){return 0!==this.passengers.length?this.passengers:this.$slots.default||[]},noWrapper:function(){var e=!this.hasAttributes&&this.slim;return e&&this.children().length>1&&console.warn("[portal-vue]: PortalTarget with `slim` option received more than one child element."),e}},render:function(e){this.$options.abstract=!0;var t=this.noWrapper(),s=this.children(),a=t?"transition":"transition-group",r=this.tag;return this.withTransition?e(a,m([this.transitionData,{class:"vue-portal-target"}]),[s]):t?s[0]:e(r,m([{class:"vue-portal-target "+this.transportedClasses.join(" ")},this.attributes]),[s])}},f="undefined"!==typeof window,b=1,g={abstract:!1,name:"portal",props:{disabled:{type:Boolean,default:!1},name:{type:String,default:function(){return String(b++)}},order:{type:Number,default:0},slim:{type:Boolean,default:!1},slotProps:{type:Object,default:function(){return{}}},tag:{type:[String],default:"DIV"},targetEl:{type:f?[String,HTMLElement]:String},targetClass:{type:String},to:{type:String,default:function(){return String(Math.round(1e7*Math.random()))}}},mounted:function(){this.targetEl&&this.mountToTarget(),this.disabled||this.sendUpdate(),this.$options.abstract&&(this.$options.abstract=!1)},updated:function(){this.disabled?this.clear():this.sendUpdate(),this.$options.abstract&&(this.$options.abstract=!1)},beforeDestroy:function(){this.clear(),this.mountedComp&&this.mountedComp.$destroy()},watch:{to:function(e,t){t&&t!==e&&this.clear(t),this.sendUpdate()},targetEl:function(e,t){e&&this.mountToTarget()}},methods:{normalizedSlots:function(){return this.$scopedSlots.default?[this.$scopedSlots.default]:this.$slots.default},sendUpdate:function(){var e=this.normalizedSlots();e?u.open({from:this.name,to:this.to,passengers:[].concat(a(e)),class:this.targetClass&&this.targetClass.split(" "),order:this.order}):this.clear()},clear:function(e){u.close({from:this.name,to:e||this.to})},mountToTarget:function(){var t=void 0,a=this.targetEl;if("string"===typeof a)t=document.querySelector(a);else{if(!(a instanceof HTMLElement))return void console.warn("[vue-portal]: value of targetEl must be of type String or HTMLElement");t=a}if(t){var n=new e(s({},h,{parent:this,propsData:{name:this.to,tag:t.tagName,attributes:r(t)}}));n.$mount(t),this.mountedComp=n}else console.warn("[vue-portal]: The specified targetEl "+a+" was not found")},normalizeChildren:function(e){return"function"===typeof e?e(this.slotProps):e}},render:function(e){var t=this.$slots.default||this.$scopedSlots.default||[],s=this.tag;return t.length&&this.disabled?(this.$options.abstract=!0,t.length<=1&&this.slim?t[0]:e(s,[this.normalizeChildren(t)])):e(s,{class:"v-portal",style:"display: none",key:"v-portal-placeholder"})}};function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.component(t.portalName||"Portal",g),e.component(t.portalTargetName||"PortalTarget",h)}"undefined"!==typeof window&&window.Vue&&window.Vue.use({install:v});var y={install:v,Portal:g,PortalTarget:h,Wormhole:u};return y})},"5f1b":function(e,t,s){"use strict";var a=s("23c6"),r=RegExp.prototype.exec;e.exports=function(e,t){var s=e.exec;if("function"===typeof s){var n=s.call(e,t);if("object"!==typeof n)throw new TypeError("RegExp exec method returned something other than an Object or null");return n}if("RegExp"!==a(e))throw new TypeError("RegExp#exec called on incompatible receiver");return r.call(e,t)}},"7f7d":function(e,t,s){"use strict";s.d(t,"a",function(){return n}),s.d(t,"b",function(){return o});s("7f7f");var a=s("5cd9"),r=s.n(a),n=r.a.Portal,i=r.a.PortalTarget,o=(r.a.Wormhole,{extends:i,name:i.name,mounted:function(){var e=this.ownTransports;e.length>0&&this.emitChange(e,[])}});r.a},"85f2":function(e,t,s){e.exports=s("454f")},b0c5:function(e,t,s){"use strict";var a=s("520a");s("5ca1")({target:"RegExp",proto:!0,forced:a!==/./.exec},{exec:a})},bd86:function(e,t,s){"use strict";s.d(t,"a",function(){return n});var a=s("85f2"),r=s.n(a);function n(e,t,s){return t in e?r()(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}},bee8:function(e,t,s){"use strict";var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"mesurement-info-wrap"},[s("kld-card",{attrs:{title:"计量信息","no-head-icon":""}},[s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:12,lg:6}},[s("el-form-item",{attrs:{label:"计量类型",prop:"depreciationType"}},[s("el-select",{attrs:{disabled:""},model:{value:e.cardItems.mtType,callback:function(t){e.$set(e.cardItems,"mtType",t)},expression:"cardItems.mtType"}},e._l(e.mtTypes,function(e,t){return s("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})}),1)],1)],1),s("el-col",{attrs:{span:12,lg:6}},[s("el-form-item",{attrs:{label:"上次计量时间",prop:"lastTime"}},[s("el-date-picker",{attrs:{editable:!1,clearable:"","value-format":"yyyy-MM-dd",placeholder:"请选择上次计量时间",disabled:e.checkMTLimit},model:{value:e.cardItems.lastTime,callback:function(t){e.$set(e.cardItems,"lastTime",t)},expression:"cardItems.lastTime"}})],1)],1),s("el-col",{attrs:{span:12,lg:6}},[s("el-form-item",{attrs:{label:"计量周期",prop:"cycle"}},[s("el-input",{attrs:{placeholder:"请填写计量周期",disabled:e.checkMTLimit},model:{value:e.cardItems.cycle,callback:function(t){e.$set(e.cardItems,"cycle",t)},expression:"cardItems.cycle"}})],1)],1)],1)],1)],1)},r=[],n=s("e1db"),i={name:"mesurement-info",mixins:[n["b"]],components:{},data:function(){return{mtTypes:[{value:0,label:"强检"},{value:1,label:"非强检"}]}},computed:{checkMTLimit:function(){return this.isAdd?this.checkLimit("ass:measurement:add"):this.checkLimit("ass:measurement:edit")}},created:function(){},methods:{}},o=i,l=s("2877"),c=Object(l["a"])(o,a,r,!1,null,"45aca5b1",null);t["a"]=c.exports}}]);
//# sourceMappingURL=chunk-3afcc6d2.3cf8a237.js.map