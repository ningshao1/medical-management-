(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-24d536fc"],{"74ef":function(e,t,a){"use strict";var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"load",rawName:"v-load",value:e.loading,expression:"loading"}],staticClass:"supplier-add"},[a("el-form",{ref:"form",attrs:{model:e.formData,rules:e.rules,"label-position":"top","label-width":"100px","validate-on-rule-change":!1}},[a("kld-card",{attrs:{title:"基础信息","no-head-icon":""}},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{xs:12,span:8}},[a("el-form-item",{attrs:{prop:"type",label:"供应商分类"}},[a("el-select",{attrs:{placeholder:"请选择供应商分类"},model:{value:e.formData.type,callback:function(t){e.$set(e.formData,"type",t)},expression:"formData.type"}},e._l(e.supplierTypes,function(e,t){return a("el-option",{key:t,attrs:{label:e,value:t}})}),1)],1)],1),a("el-col",{attrs:{xs:12,span:8}},[a("el-form-item",{attrs:{prop:"supplierName",label:"供应商名称"}},[a("el-input",{attrs:{placeholder:"请输入供应商名称"},model:{value:e.formData.supplierName,callback:function(t){e.$set(e.formData,"supplierName",t)},expression:"formData.supplierName"}})],1)],1),a("el-col",{attrs:{xs:12,span:8}},[a("el-form-item",{attrs:{prop:"supplierContactName",label:"联系人"}},[a("el-input",{attrs:{placeholder:"请输入联系人"},model:{value:e.formData.supplierContactName,callback:function(t){e.$set(e.formData,"supplierContactName",t)},expression:"formData.supplierContactName"}})],1)],1),a("el-col",{attrs:{xs:12,span:8}},[a("el-form-item",{attrs:{prop:"supplierPhone",label:"联系方式"}},[a("kld-input-number",{attrs:{precision:0,placeholder:"请输入联系方式"},model:{value:e.supplierPhone,callback:function(t){e.supplierPhone=t},expression:"supplierPhone"}})],1)],1),a("el-col",{attrs:{xs:12,span:8}},[a("el-form-item",{attrs:{prop:"provinceid",label:"供应商地址"}},[a("select-area",{attrs:{placeholder:"请选择地区"},model:{value:e.supplierArea,callback:function(t){e.supplierArea=t},expression:"supplierArea"}})],1)],1),a("el-col",{attrs:{xs:12,span:8}},[a("el-form-item",{attrs:{prop:"addressDetail"}},[a("template",{slot:"label"},[e._v(" ")]),a("el-input",{attrs:{placeholder:"请输入详细地址"},model:{value:e.formData.addressDetail,callback:function(t){e.$set(e.formData,"addressDetail",t)},expression:"formData.addressDetail"}})],2)],1),a("el-col",{attrs:{span:24}},[a("el-form-item",{attrs:{prop:"labelIds"}},[a("template",{slot:"label"},[e._v("\n                            供应商标签\n                            "),a("span",{staticClass:"text-secondary"},[e._v("（每个供应商最多添加5个标签）")])]),a("select-supplier-tag",{model:{value:e.formData.labelIds,callback:function(t){e.$set(e.formData,"labelIds",t)},expression:"formData.labelIds"}})],2)],1)],1)],1),a("kld-card",{attrs:{title:"相关资质信息","no-head-icon":""}},[a("kld-form-item",{attrs:{prop:"businessPhotos","label-width":"100%"},scopedSlots:e._u([{key:"label",fn:function(t){var r=t.Asterisk;return[e._v("\n                    营业执照\n                    "),a(r,{tag:"component"}),a("span",{staticClass:"text-secondary"},[e._v("（支持上传最多5张图片或单个图片最大3M）")])]}}])},[a("file-upload",e._b({ref:"business-upload",attrs:{images:e.formData.businessPhotos,"action-image":"/photo/"+e.hospitalId+"/3/upload"},on:{"update:images":function(t){e.$set(e.formData,"businessPhotos",t)}}},"file-upload",e.uploadCommonProps,!1))],1),a("kld-form-item",{attrs:{prop:"licensePhotos","label-width":"100%"},scopedSlots:e._u([{key:"label",fn:function(t){var r=t.Asterisk;return[e._v("\n                    医疗器械经营许可证\n                    "),a(r,{tag:"component"}),a("span",{staticClass:"text-secondary"},[e._v("（支持上传最多5张图片或单个图片最大3M）")])]}}])},[a("file-upload",e._b({ref:"license-upload",attrs:{images:e.formData.licensePhotos,"action-image":"/photo/"+e.hospitalId+"/4/upload"},on:{"update:images":function(t){e.$set(e.formData,"licensePhotos",t)}}},"file-upload",e.uploadCommonProps,!1))],1),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{attrs:{prop:"licenseDate",label:"医疗器械经营许可证到期时间"}},[a("el-date-picker",{attrs:{placeholder:"请选择到期时间"},model:{value:e.formData.licenseDate,callback:function(t){e.$set(e.formData,"licenseDate",t)},expression:"formData.licenseDate"}})],1)],1)],1)],1)],1),a("Portal",{attrs:{to:"action"}},[a("el-button",{attrs:{size:"large",loading:e.submitLoading},on:{click:e.submit}},[e._v("提交")]),a("el-button",{attrs:{type:"default",size:"large"},on:{click:e.goBack}},[e._v("返回")])],1)],1)},n=[],s=a("795b"),i=a.n(s),l=(a("ac6a"),a("5df3"),a("96cf"),a("3b8d")),o=a("a4bb"),u=a.n(o),c=(a("6c7b"),a("768b")),p=(a("c5f6"),a("cebc")),d=a("9cef"),m=a("3e2a"),f=a("7f7d"),h=a("9b5c"),b=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-cascader",e._b({staticClass:"select-area",attrs:{options:e.areaData},on:{"active-item-change":e.activeItemChange},model:{value:e.selected,callback:function(t){e.selected=t},expression:"selected"}},"el-cascader",e.$attrs,!1))},v=[],g=a("a745"),D=a.n(g),x=(a("7514"),a("7618")),y=(a("6762"),a("5d73")),k=a.n(y),w=[71e4,81e4,82e4],P=function(e){var t=!0,a=!1,r=void 0;try{for(var n,s=k()(e);!(t=(n=s.next()).done);t=!0){var i=n.value;w.includes(i.value)||3===i.type||(i.children=[])}}catch(l){a=!0,r=l}finally{try{t||null==s.return||s.return()}finally{if(a)throw r}}return e},$={name:"select-area",props:{value:{type:Array,default:function(){return[]}}},data:function(){return{areaData:[]}},computed:{selected:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},watch:{selected:{immediate:!0,handler:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var a,r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(0!==this.areaData.length){e.next=3;break}return e.next=3,this.initAreaData();case 3:a=0,r=t.length;case 4:if(!(a<r)){e.next=10;break}return e.next=7,this.activeItemChange(t.slice(0,a+1));case 7:a++,e.next=4;break;case 10:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()}},methods:{getAreaData:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t,a,r,n=arguments;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]?n[0]:[],e.next=3,this.$axios.get("/address/provinceList/".concat(t.join("/")));case 3:return a=e.sent,r=a.data,e.abrupt("return",P(r));case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),findAreaData:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this.areaData,a=null,r=!0,n=!1,s=void 0;try{for(var i,l=function(){var e=i.value,r=t.find(function(t){return t.value===e});if(!r)return{v:null};t=r.children,a=r},o=k()(e);!(r=(i=o.next()).done);r=!0){var u=l();if("object"===Object(x["a"])(u))return u.v}}catch(c){n=!0,s=c}finally{try{r||null==o.return||o.return()}finally{if(n)throw s}}return a},activeItemChange:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(t){var a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(a=this.findAreaData(t),!a||!D()(a.children)||0!==a.children.length){e.next=5;break}return e.next=4,this.getAreaData(t);case 4:a.children=e.sent;case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),initAreaData:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getAreaData();case 2:this.areaData=e.sent;case 3:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},C=$,_=a("2877"),j=Object(_["a"])(C,b,v,!1,null,null,null),I=j.exports,A=a("17ea"),N=a("ed08"),R=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("select-tag",{staticClass:"select-supplier-tag",attrs:{data:e.tags,"label-key":"labelName",max:5},model:{value:e.selectedTags,callback:function(t){e.selectedTags=t},expression:"selectedTags"}})},O=[],T=a("0d0a"),S={name:"select-supplier-tag",components:{SelectTag:T["a"]},props:{value:{}},data:function(){return{tags:[]}},computed:{selectedTags:{get:function(){return this.value},set:function(e){this.$emit("input",e)}}},created:function(){this.getTags()},methods:{getTags:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){var t,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$axios.post("/labels/list/4");case 2:t=e.sent,a=t.data,this.tags=a;case 5:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}()}},q=S,L=Object(_["a"])(q,R,O,!1,null,"84560cf8",null),M=L.exports,z={name:"supplier-add",components:{KldCard:d["a"],SelectSupplierTag:M,FileUpload:m["a"],Portal:f["a"],KldInputNumber:h["a"],SelectArea:I,KldFormItem:A["a"]},data:function(){return{formData:{type:0,supplierName:null,supplierContactName:null,supplierPhone:null,addressDetail:null,areaid:null,cityid:null,provinceid:null,labelIds:[],businessPhotos:[],licensePhotos:[],licenseDate:null,osID:this.$store.state.userInfo.osId},submitLoading:!1,loading:!1}},computed:{rules:function(){return Object(p["a"])({type:{required:!0,message:"供应商分类为必选"},supplierName:{required:!0,message:"供应商名称为必填"},supplierContactName:{required:!0,message:"联系人为必填"},supplierPhone:{required:!0,message:"联系方式为必填"}},this.dynamicRules)},dynamicRules:function(){var e=0===this.formData.type;return{businessPhotos:{required:e,message:"必须上传营业执照"},licensePhotos:{required:e,message:"必须上传医疗器械经营许可证"},licenseDate:{required:e,message:"许可证到期时间为必选"}}},supplierPhone:{get:function(){var e=this.formData.supplierPhone;if(Object(N["c"])(e))return Number(this.formData.supplierPhone)},set:function(e){this.formData.supplierPhone=Object(N["c"])(e)?String(e):null}},supplierArea:{get:function(){var e=this.formData,t=e.provinceid,a=e.cityid,r=e.areaid;return[t,a,r].filter(N["c"])},set:function(e){var t=this.formData,a=e.concat(new Array(3-e.length).fill(null)),r=Object(c["a"])(a,3);t.provinceid=r[0],t.cityid=r[1],t.areaid=r[2]}},supplierTypes:function(){return["设备供应商","保养供应商","计量机构"]},uploadCommonProps:function(){return{limit:5,maxSize:3145728,accept:[".jpeg",".jpg",".png",".gif"]}},hospitalId:function(){return this.$store.state.userInfo.osId},submitConfig:function(){return{method:"post",url:["/supplier","/measurement/savaMaintain","/measurement/saveMeasurement"][this.formData.type],data:this.formData}}},watch:{dynamicRules:function(e){this.clearValidate(u()(e))}},methods:{submit:function(){var e=Object(l["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.$refs.form.validate();case 2:return e.next=4,i.a.all([this.$refs["business-upload"].upload(),this.$refs["license-upload"].upload()]);case 4:return this.submitLoading=!0,e.prev=5,e.next=8,this.$axios(this.submitConfig);case 8:this.$message({type:"success",message:"提交成功"}),this.goBack();case 10:return e.prev=10,this.submitLoading=!0,e.finish(10);case 13:case"end":return e.stop()}},e,this,[[5,,10,13]])}));function t(){return e.apply(this,arguments)}return t}(),goBack:function(){this.$router.back()},clearValidate:function(e){var t=this.$refs.form;t&&t.clearValidate(e)}}},B=z,E=Object(_["a"])(B,r,n,!1,null,"6c62230b",null);t["a"]=E.exports},b267:function(e,t,a){"use strict";a.r(t);var r=a("74ef");a.d(t,"default",function(){return r["a"]})}}]);
//# sourceMappingURL=chunk-24d536fc.3311a671.js.map